# Demo

CFR_Leduc_Poker.py

# notes

if wandb_save == True, you can save result on your wandb.

# config1

```python
algorithm_candicates = ["vanilla_CFR", "chance_sampling_CFR", "external_sampling_MCCFR", "outcome_sampling_MCCFR"]
algo = algorithm_candicates[1]
train_iterations = 10**5
num_players =  2
wandb_save = True
```

# train1

```python
leduc_trainer = LeducTrainer(train_iterations=train_iterations, num_players=num_players)
leduc_trainer.train(algo)
```

# result1

```python
avg util: -0.08853304762222737
```

<p align="center">
  <img src="https://user-images.githubusercontent.com/63486375/167861760-aecfb4eb-f187-4885-b2c4-bc540028d3db.png", width=640>
</p>

```python
               Fold      Call     Raise
Node
J          0.000000  0.917487  0.082513
Jc         0.000000  0.732171  0.267829
JccJ       0.000000  0.998694  0.001306
JccJc      0.000000  0.000057  0.999943
JccJcr     0.000014  0.000014  0.999973
JccJcrr    0.000028  0.999972  0.000000
JccJr      0.000163  0.499919  0.499919
JccJrr     0.015572  0.984428  0.000000
JccK       0.000000  0.915257  0.084743
JccKc      0.000000  0.996627  0.003373
JccKcr     0.999726  0.000006  0.000269
JccKcrr    0.961920  0.038080  0.000000
JccKr      1.000000  0.000000  0.000000
JccKrr     1.000000  0.000000  0.000000
JccQ       0.000000  0.859080  0.140920
JccQc      0.000000  0.943342  0.056658
JccQcr     0.999968  0.000016  0.000016
JccQcrr    0.999775  0.000225  0.000000
JccQr      0.951652  0.000017  0.048331
JccQrr     0.999854  0.000146  0.000000
Jcr        0.937622  0.044051  0.018327
JcrcJ      0.000000  0.093099  0.906901
JcrcJc     0.000000  0.001676  0.998324
JcrcJcr    0.001115  0.001115  0.997770
JcrcJcrr   0.000839  0.999161  0.000000
JcrcJr     0.001117  0.006044  0.992839
JcrcJrr    0.000172  0.999828  0.000000
JcrcK      0.000000  0.849706  0.150294
JcrcKc     0.000000  0.520944  0.479056
JcrcKcr    0.823172  0.000000  0.176828
JcrcKcrr   0.999854  0.000146  0.000000
JcrcKr     0.890571  0.000093  0.109336
JcrcKrr    1.000000  0.000000  0.000000
JcrcQ      0.000000  0.086760  0.913240
JcrcQc     0.000000  0.558723  0.441277
JcrcQcr    0.972974  0.002697  0.024329
JcrcQcrr   0.999921  0.000079  0.000000
JcrcQr     0.932188  0.000047  0.067765
JcrcQrr    0.999616  0.000384  0.000000
Jcrr       0.002131  0.997869  0.000000
JcrrcJ     0.000000  0.259011  0.740989
JcrrcJc    0.000000  0.000609  0.999391
JcrrcJcr   0.000898  0.000898  0.998205
JcrrcJcrr  0.000305  0.999695  0.000000
JcrrcJr    0.001233  0.001784  0.996983
JcrrcJrr   0.000471  0.999529  0.000000
JcrrcK     0.000000  0.045022  0.954978
JcrrcKc    0.000000  0.501021  0.498979
JcrrcKcr   1.000000  0.000000  0.000000
JcrrcKcrr  0.999930  0.000070  0.000000
JcrrcKr    0.748133  0.000047  0.251820
JcrrcKrr   1.000000  0.000000  0.000000
JcrrcQ     0.000000  0.998796  0.001204
JcrrcQc    0.000000  0.901193  0.098807
JcrrcQcr   0.981793  0.000460  0.017746
JcrrcQcrr  0.994433  0.005567  0.000000
JcrrcQr    0.951403  0.000149  0.048448
JcrrcQrr   0.500000  0.500000  0.000000
Jr         0.792399  0.145292  0.062310
JrcJ       0.000000  0.322304  0.677696
JrcJc      0.000000  0.000754  0.999246
JrcJcr     0.000470  0.000782  0.998748
JrcJcrr    0.000085  0.999915  0.000000
JrcJr      0.000536  0.000538  0.998926
JrcJrr     0.000335  0.999665  0.000000
JrcK       0.000000  0.062523  0.937477
JrcKc      0.000000  0.677516  0.322484
JrcKcr     0.416118  0.002376  0.581505
JrcKcrr    0.999767  0.000233  0.000000
JrcKr      0.731876  0.000065  0.268059
JrcKrr     0.999676  0.000324  0.000000
JrcQ       0.000000  0.044244  0.955756
JrcQc      0.000000  0.225094  0.774906
JrcQcr     0.956831  0.000168  0.043001
JrcQcrr    0.999927  0.000073  0.000000
JrcQr      0.999577  0.000123  0.000299
JrcQrr     0.999876  0.000124  0.000000
Jrr        0.000091  0.999909  0.000000
JrrcJ      0.000000  0.004996  0.995004
JrrcJc     0.000000  0.003264  0.996736
JrrcJcr    0.015152  0.015152  0.969695
JrrcJcrr   0.000481  0.999519  0.000000
JrrcJr     0.001407  0.008396  0.990197
JrrcJrr    0.000114  0.999886  0.000000
JrrcK      0.000000  0.591961  0.408039
JrrcKc     0.000000  0.008268  0.991732
JrrcKcr    0.349280  0.000760  0.649960
JrrcKcrr   0.999600  0.000400  0.000000
JrrcKr     0.674892  0.000529  0.324579
JrrcKrr    0.996990  0.003010  0.000000
JrrcQ      0.000000  0.830235  0.169765
JrrcQc     0.000000  0.800086  0.199914
JrrcQcr    0.990109  0.000000  0.009891
JrrcQcrr   0.997168  0.002832  0.000000
JrrcQr     0.584489  0.000546  0.414965
JrrcQrr    1.000000  0.000000  0.000000
K          0.000000  0.276077  0.723923
Kc         0.000000  0.000396  0.999604
KccJ       0.000000  0.999932  0.000068
KccJc      0.000000  0.872069  0.127931
KccJcr     0.997739  0.001825  0.000436
KccJcrr    0.377216  0.622784  0.000000
KccJr      0.839897  0.073319  0.086783
KccJrr     0.500000  0.500000  0.000000
KccK       0.000000  0.006481  0.993519
KccKc      0.000000  0.000000  1.000000
KccKcr     0.013975  0.013975  0.972051
KccKcrr    0.000000  1.000000  0.000000
KccKr      0.000000  0.000000  1.000000
KccKrr     0.000137  0.999863  0.000000
KccQ       0.000000  0.999864  0.000136
KccQc      0.000000  0.884684  0.115316
KccQcr     0.630536  0.369418  0.000045
KccQcrr    0.138787  0.861213  0.000000
KccQr      0.179312  0.567340  0.253349
KccQrr     0.500000  0.500000  0.000000
Kcr        0.000207  0.290764  0.709029
KcrcJ      0.000000  0.996265  0.003735
KcrcJc     0.000000  0.915156  0.084844
KcrcJcr    0.002280  0.994062  0.003658
KcrcJcrr   0.000070  0.999930  0.000000
KcrcJr     0.267191  0.725891  0.006919
KcrcJrr    0.809598  0.190402  0.000000
KcrcK      0.000000  0.701506  0.298494
KcrcKc     0.000000  0.000392  0.999608
KcrcKcr    0.000123  0.000123  0.999754
KcrcKcrr   0.000114  0.999886  0.000000
KcrcKr     0.000051  0.250013  0.749937
KcrcKrr    0.000434  0.999566  0.000000
KcrcQ      0.000000  0.208526  0.791474
KcrcQc     0.000000  0.695538  0.304462
KcrcQcr    0.283532  0.716226  0.000242
KcrcQcrr   0.948479  0.051521  0.000000
KcrcQr     0.553833  0.445115  0.001052
KcrcQrr    0.994590  0.005410  0.000000
Kcrr       0.000007  0.999993  0.000000
KcrrcJ     0.000000  0.942098  0.057902
KcrrcJc    0.000000  0.720652  0.279348
KcrrcJcr   0.021622  0.972827  0.005551
KcrrcJcrr  0.007647  0.992353  0.000000
KcrrcJr    0.120341  0.821912  0.057747
KcrrcJrr   0.269451  0.730549  0.000000
KcrrcK     0.000000  0.126579  0.873421
KcrrcKc    0.000000  0.001664  0.998336
KcrrcKcr   0.000591  0.000669  0.998740
KcrrcKcrr  0.000228  0.999772  0.000000
KcrrcKr    0.000051  0.000098  0.999851
KcrrcKrr   0.000129  0.999871  0.000000
KcrrcQ     0.000000  0.892554  0.107446
KcrrcQc    0.000000  0.447674  0.552326
KcrrcQcr   0.293427  0.663056  0.043517
KcrrcQcrr  0.478910  0.521090  0.000000
KcrrcQr    0.280444  0.499664  0.219892
KcrrcQrr   0.619287  0.380713  0.000000
Kr         0.000020  0.369169  0.630811
KrcJ       0.000000  0.916555  0.083445
KrcJc      0.000000  0.430383  0.569617
KrcJcr     0.094068  0.890733  0.015199
KrcJcrr    0.084116  0.915884  0.000000
KrcJr      0.222485  0.774555  0.002960
KrcJrr     0.190999  0.809001  0.000000
KrcK       0.000000  0.131816  0.868184
KrcKc      0.000000  0.000426  0.999574
KrcKcr     0.000000  0.000000  1.000000
KrcKcrr    0.000213  0.999787  0.000000
KrcKr      0.000284  0.001279  0.998438
KrcKrr     0.000000  1.000000  0.000000
KrcQ       0.000000  0.966128  0.033872
KrcQc      0.000000  0.906637  0.093363
KrcQcr     0.492107  0.507799  0.000094
KrcQcrr    0.954376  0.045624  0.000000
KrcQr      0.649663  0.347738  0.002599
KrcQrr     0.959570  0.040430  0.000000
Krr        0.000059  0.999941  0.000000
KrrcJ      0.000000  0.902069  0.097931
KrrcJc     0.000000  0.600827  0.399173
KrrcJcr    0.000338  0.993689  0.005974
KrrcJcrr   0.000025  0.999975  0.000000
KrrcJr     0.034404  0.907672  0.057923
KrrcJrr    0.075646  0.924354  0.000000
KrrcK      0.000000  0.504948  0.495052
KrrcKc     0.000000  0.000113  0.999887
KrrcKcr    0.000000  0.000000  1.000000
KrrcKcrr   0.000405  0.999595  0.000000
KrrcKr     0.000076  0.381455  0.618469
KrrcKrr    0.000000  1.000000  0.000000
KrrcQ      0.000000  0.394077  0.605923
KrrcQc     0.000000  0.532287  0.467713
KrrcQcr    0.272797  0.663994  0.063208
KrrcQcrr   0.449571  0.550429  0.000000
KrrcQr     0.366852  0.579689  0.053459
KrrcQrr    0.621487  0.378513  0.000000
Q          0.000000  0.302106  0.697894
Qc         0.000000  0.141169  0.858831
QccJ       0.000000  0.999368  0.000632
QccJc      0.000000  0.992850  0.007150
QccJcr     0.999384  0.000083  0.000534
QccJcrr    0.999706  0.000294  0.000000
QccJr      0.999176  0.000358  0.000466
QccJrr     0.803596  0.196404  0.000000
QccK       0.000000  0.413145  0.586855
QccKc      0.000000  0.983862  0.016138
QccKcr     0.000100  0.977864  0.022036
QccKcrr    0.004035  0.995965  0.000000
QccKr      0.244979  0.731134  0.023887
QccKrr     0.000106  0.999894  0.000000
QccQ       0.000000  0.653811  0.346189
QccQc      0.000000  0.001079  0.998921
QccQcr     0.000063  0.000138  0.999799
QccQcrr    0.000540  0.999460  0.000000
QccQr      0.000719  0.285817  0.713464
QccQrr     0.000178  0.999822  0.000000
Qcr        0.078192  0.721560  0.200248
QcrcJ      0.000000  0.952507  0.047493
QcrcJc     0.000000  0.589751  0.410249
QcrcJcr    0.992460  0.000000  0.007540
QcrcJcrr   0.999840  0.000160  0.000000
QcrcJr     0.998039  0.000095  0.001866
QcrcJrr    1.000000  0.000000  0.000000
QcrcK      0.000000  0.992580  0.007420
QcrcKc     0.000000  0.538416  0.461584
QcrcKcr    0.421893  0.576724  0.001383
QcrcKcrr   0.949918  0.050082  0.000000
QcrcKr     0.475523  0.521793  0.002683
QcrcKrr    0.971555  0.028445  0.000000
QcrcQ      0.000000  0.005600  0.994400
QcrcQc     0.000000  0.000087  0.999913
QcrcQcr    0.003375  0.011394  0.985232
QcrcQcrr   0.000044  0.999956  0.000000
QcrcQr     0.000058  0.000142  0.999799
QcrcQrr    0.000029  0.999971  0.000000
Qcrr       0.000283  0.999717  0.000000
QcrrcJ     0.000000  0.956769  0.043231
QcrrcJc    0.000000  0.999305  0.000695
QcrrcJcr   0.999572  0.000214  0.000214
QcrrcJcrr  0.841902  0.158098  0.000000
QcrrcJr    0.978571  0.000116  0.021313
QcrrcJrr   0.992888  0.007112  0.000000
QcrrcK     0.000000  0.325796  0.674204
QcrrcKc    0.000000  0.945478  0.054522
QcrrcKcr   0.359488  0.626165  0.014346
QcrrcKcrr  0.986986  0.013014  0.000000
QcrrcKr    0.724255  0.275569  0.000176
QcrrcKrr   0.995133  0.004867  0.000000
QcrrcQ     0.000000  0.560041  0.439959
QcrrcQc    0.000000  0.000251  0.999749
QcrrcQcr   0.000124  0.001028  0.998848
QcrrcQcrr  0.000126  0.999874  0.000000
QcrrcQr    0.000119  0.006525  0.993356
QcrrcQrr   0.000237  0.999763  0.000000
Qr         0.010210  0.593051  0.396740
QrcJ       0.000000  0.981182  0.018818
QrcJc      0.000000  0.993134  0.006866
QrcJcr     0.999323  0.000007  0.000670
QrcJcrr    1.000000  0.000000  0.000000
QrcJr      0.967501  0.000000  0.032499
QrcJrr     1.000000  0.000000  0.000000
QrcK       0.000000  0.508703  0.491297
QrcKc      0.000000  0.628006  0.371994
QrcKcr     0.468854  0.495472  0.035674
QrcKcrr    0.899750  0.100250  0.000000
QrcKr      0.651020  0.347614  0.001366
QrcKrr     0.791820  0.208180  0.000000
QrcQ       0.000000  0.341820  0.658180
QrcQc      0.000000  0.000000  1.000000
QrcQcr     0.000096  0.000096  0.999808
QrcQcrr    0.000000  1.000000  0.000000
QrcQr      0.000000  0.000210  0.999790
QrcQrr     0.000041  0.999959  0.000000
Qrr        0.000011  0.999989  0.000000
QrrcJ      0.000000  0.999521  0.000479
QrrcJc     0.000000  0.995879  0.004121
QrrcJcr    1.000000  0.000000  0.000000
QrrcJcrr   0.907381  0.092619  0.000000
QrrcJr     0.999260  0.000328  0.000411
QrrcJrr    1.000000  0.000000  0.000000
QrrcK      0.000000  0.900571  0.099429
QrrcKc     0.000000  0.592154  0.407846
QrrcKcr    0.697599  0.302375  0.000026
QrrcKcrr   0.995749  0.004251  0.000000
QrrcKr     0.520249  0.478206  0.001545
QrrcKrr    0.999284  0.000716  0.000000
QrrcQ      0.000000  0.071613  0.928387
QrrcQc     0.000000  0.000942  0.999058
QrrcQcr    0.000125  0.000730  0.999145
QrrcQcrr   0.000471  0.999529  0.000000
QrrcQr     0.000126  0.000928  0.998947
QrrcQrr    0.000014  0.999986  0.000000
```

# train2 (calculate random strategy_profile exploitability)

```python
for i in range(2,3):
  kuhn_poker_agent = LeducTrainer(train_iterations=0, num_players=i)
  print("{}player game:".format(i), kuhn_poker_agent.get_exploitability_dfs())
```

# result2

```python
2player game: 4.747222222222224
```
